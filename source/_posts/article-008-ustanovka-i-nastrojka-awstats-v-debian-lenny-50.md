layout: post
title: Установка и настройка AWstats в Debian Lenny (5.0)
date: 2009-05-20
tags:
- debian-lenny
- awstats
- ubuntu
- debian
- статистика
categories: articles
permalink: ustanovka-i-nastrojka-awstats-v-debian-lenny-50

---

**AWstats** - одна из популярных **систем анализа лог файлов (Log Analyzer)**. **AWStats** является свободным, мощным и расширяемым за счет плагинов инструментом **генерации интернет статистики**. Позволяет анализировать различиные типы логов: HTTP, FTP и SMTP. Предоставляет удобный интерфейс для просмотра статистики "из коробки".

**AWstats** является достойной заменой таким **системам анализа лог файлов**, как **Analog** и **Webalizer**.

<!-- more -->

Обзор AWstats
=============

**AWstats** написан на Perl. Показывает такую статистику, как: поситетели, уникальные поситетели, страницы, количество кликов, часы пик, поисковые сервисы, ключевые слова, использованные для поиска вашего сайта, роботов, нерабочие ссылки и другое. Дает более детальную информацию и графики чем webalizer, и прост в использовании.

**AWstats** работает в двух режимах: из командной строки - для **анализа лог файлов** и генерации **статистики посещений**, а так же как CGI-приложение - для просмтора сгенерированной **статистики посещений**. Для минимизации времени обработки **AWstats** использует только необходимый минимум информации при **анализе лог файлов**. Таким образом, его можно запускать часто и для больших лог файлов (в зависимости от начального объема лог-файла, первый запуск **анализа лог файлов** может занять значительно бОльшее время, чем все последующие).

Поддерживает более 30 языков.

Установка AWstats
=================

Установка AWstats достаточно проста:

``` bash
    $ sudo aptitude update
    $ sudo aptitude install awstats
```
Базовая настройка AWstats
=========================

Первым делом, будет необходимо настроить хотя бы один журнал для анализа.

Настройка AWstats для анализа лог файлов
----------------------------------------

Все **настройки AWstats** находятся в директории */etc/awstats*. Каждый конфиг именуется слудющим образом: *awstats.название_хоста.conf*. Например, для **DebianWorld.Ru** файл будет именоваться следующим образом: awstats.debianworld.ru.conf .

По умолчанию, **AWstats** предоставляет дефолтный файл конфигурации: /etc/awstats/awstats.conf. Чтобы сделать свою конфигурацию, необходимо просто скопировать дефотный файл и отредактировать его:

``` bash
    $ sudo cp /etc/awstats/awstats.conf /etc/awstats/awstats.debianworld.ru.conf
    $ sudo vim /etc/awstats/awstats.debianworld.ru.conf
```
В первую очередь, необходимо найти и отредактировать следующие строки:

``` bash
    # Анализируемый лог файл
    LogFile="/var/log/httpd/mylog.log"
    # Хост, чей лог будет анализироваться
    SiteDomain=""
    # Директория, куда будет складироваться сгенерированная статистика посещений
    DirData="."
```
Например, так:

``` bash
    # Анализируемый лог файл
    LogFile="/var/www/debianworld.ru/logs/apache_access.log"
    # Хост, чей лог будет анализироваться
    SiteDomain="DebianWorld.Ru"
    # Директория, куда будет складироваться сгенерированная статистика посещений
    DirData="/var/www/debianworld.ru/awstats"
```
Первый запуск AWstats для анализа лог файлов
--------------------------------------------

Для того, чтобы сгенерировать первую статистику, необходимо выполнить скрипт от рута:

``` bash
    $ sudo -u www-data /usr/bin/perl /usr/lib/cgi-bin/awstats.pl -update -config=debianworld.ru
```
*Внимание*: важно обратить внимание, что конфиг при запуске указывается не так, как он называется в файловой системе. То есть, при запуске скрипта анализа статистике опускаются начальное "awstats" и оконечное "conf".

Настройка Apache для просмотра статистики AWstats
-------------------------------------------------

Чтобы иметь возможность просмотра сгенерированной статистики посещений, необходимо настроить HTTP-сервер, например, один из самых популярых - apache2.
Вместе с **AWstats** идет дефолтный файл конфигурации для Apache2. Необходимо скопировать его в директорию apache2 и перезагрузить apache2:

``` bash
    $ sudo cp /usr/share/doc/awstats/examples/apache.conf /etc/apache2/conf.d/awstats
    $ sudo /etc/init.d/apache2 reload
```
Теперь, просмотреть сгенерированную статистику посещений, можно сделав запрос к своему HTTP-серверу со следующим запросом */cgi-bin/awstats.pl* (полный запрос на примере debianworld.ru: http://debianworld.ru/cgi-bin/awstats.pl).
